#!/usr/bin/env python
# coding: utf-8

# # REPORTE 2
# 
# ## Lectura

# La Historia Monetaria y Fiscal del Per√∫, 1960-2017 escrito por Marco Vega y C√©sar Martinelli tiene como objetivo explicar los periodos de inflaci√≥n, hiperinflaci√≥n y estabilizaci√≥n entre 1970 y 1990 en el Per√∫, al igual que sus efectos en la historia macroecon√≥mica posterior hasta la actualidad. As√≠, mediante ejercicios de crecimiento y contabilidad fiscal muestran los problemas y la raz√≥n detr√°s del periodo de inflaci√≥n entre los 70‚Äôs e inicios de los 80‚Äôs. Luego, discuten como la inflaci√≥n se volvi√≥ una hiperinflaci√≥n en los 80‚Äôs y debido a ser un r√©gimen con una pol√≠tica fiscal predominantemente monetaria y una administraci√≥n populista que estableci√≥ una pol√≠tica contraproducente de control de precios y cr√©dito laxo, esta no pudo ser controlada hasta 1990. A partir de este a√±o se evidenci√≥ un periodo de estabilizaci√≥n junto con el cambio de las pol√≠ticas econ√≥micas y una actitud m√°s responsable por parte de los pol√≠ticos en cuanto a materia fiscal y monetaria. Finalmente, los autores comparten que si bien a partir de 1990, despu√©s de un traum√°tico periodo de inflaci√≥n e hiperinflaci√≥n, la actitud de los pol√≠ticos fue m√°s favorable para la estabilizaci√≥n econ√≥mica, ya que no estaban en contra de la intervenci√≥n estatal ni buscaban de manera abierta satisfacer sus intereses, el estado peruano a√∫n enfrenta problemas internos graves como la corrupci√≥n y la lucha pol√≠tica interna entre poderes del Estado, lo que de no ser controlado a tiempo puede poner en peligro la estabilidad institucional y sobre todo, la estabilidad macroecon√≥mica del pa√≠s. Por tanto, en base a los temas tocados en el art√≠culo, considero que la pregunta de investigaci√≥n es: ¬øCu√°les son las causas y efectos en la pol√≠tica macroecon√≥mica actual de los periodos de inflaci√≥n, hiperinflaci√≥n y estabilidad econ√≥mica en el Per√∫ entre 1970-1990? 
# 
# Ante esta pregunta, la tesis de los autores es que los periodos de inflaci√≥n econ√≥mica antes de la entrada al gobierno de Fujimori en 1990 se debieron a la necesidad de impuestos inflacionarios en un gobierno que manten√≠a una dominancia fiscal de la pol√≠tica monetaria. Adem√°s, la intensificaci√≥n de este fen√≥meno macroecon√≥mico se dio en parte por una administraci√≥n populista que potenci√≥ pol√≠ticas econ√≥micas deficientes de cr√©dito flexible y control de precios. Sin embargo, estas experiencias dieron paso al aprendizaje social de la poblaci√≥n peruana y sus autoridades, lo que deriv√≥ en la independencia de la pol√≠tica monetaria bajo una instituci√≥n separada y pol√≠ticas fiscales m√°s moderadas, siendo esto lo que permiti√≥ el mantenimiento de la estabilidad econ√≥mica en el pa√≠s hasta a√±os posteriores.
# 
# Asimismo, como toda investigaci√≥n este art√≠culo presenta ciertas fortalezas y debilidades. En primer lugar, cabe destacar que entre sus fortalezas se encuentran su ‚Äúenfoque h√≠brido‚Äù y la manera en que est√° organizado el art√≠culo, pues ambos autores mencionan que si bien su estudio sigue un enfoque monetario este se complementa con una perspectiva institucional. Adem√°s, el que utilicen no solo ejercicios de crecimiento y contabilidad fiscal para evidenciar los periodos de inflaci√≥n en la econom√≠a peruana, sino que tambi√©n los contextualicen con la realidad del regimen y las decisiones en materia de pol√≠ticas macroecon√≥micas que se tomaron en cada periodo, les permite a los autores evaluar de mejor manera las crisis econ√≥micas inflacionarias, sus causas relevantes y sobre todo sus efectos en la pol√≠tica macroecon√≥mica posterior. Igualmente, a los lectores les brindar√° una visi√≥n m√°s integral y secuencial del problema econ√≥mico a partir de un an√°lisis cuantitativo y cualitativo de este.
# 
# De la misma manera, el art√≠culo est√° organizado de una manera secuencial y utiliza gr√°ficos y cuadros estad√≠sticos para dinamizar la comprensi√≥n de los lectores, pues a partir de su propia evaluaci√≥n de los gr√°ficos presentados, ellos podr√°n llegar a una conclusi√≥n propia e incluso podr√≠an cuestionar el planteamiento de los autores o corroborar su interpretaci√≥n de los gr√°ficos, lo que en suma, les ofrecer√° un mejor entendimiento de las crisis inflacionarias en el Per√∫ y sus efectos actuales. 
# 
# No obstante, como cualquier otra investigaci√≥n, esta presenta una importante debilidad, la cual, podr√≠a afectar de cierta manera la confiabilidad del art√≠culo. Esta consiste en que inevitablemente, durante los periodos de crisis inflacionaria y estabilizaci√≥n econ√≥mica las tasas de cambio real fueron cambiando y estos procesos de transformaci√≥n no fueron documentados debidamente, por ende, el que ellos utilizaran estos datos incompletos, significa que de manera inevitable su investigaci√≥n tendr√° ciertos espacios sin corroborar, que deber√°n ser evaluados por los lectores para realizar su conclusi√≥n final sobre el problema inflacionario y su influencia posterior.
# 
# Por otro lado, si bien la investigaci√≥n presenta determinadas fortalezas y una debilidad inevitable, su contribuci√≥n al mundo acad√©mico y la sociedad en general es innegable. Esto debido a que, como hemos visto, con su estudio van a mejorar la comprensi√≥n de los lectores sobre las crisis inflacionarias y les permitir√°n sacar sus propias conclusiones sobre los efectos que este periodo traum√°tico gener√≥ para la pol√≠tica macroecon√≥mica y sociedad actual. Les brindar√°n razones para entender que la percepci√≥n negativa de los peruanos sobre el intervencionismo estatal, la promoci√≥n del libre mercado por parte de pol√≠ticos peruanos desde los 2000, la independizaci√≥n de la pol√≠tica monetaria en un banco central aut√≥nomo, el alejamiento de una administraci√≥n fiscal populista, los controles sobre la capacidad de gasto del Congreso y en s√≠ la moderaci√≥n de la pol√≠tica fiscal, han probado ser intervenciones adecuadas ligadas al aprendizaje social de la sociedad peruana. 
# 
# Igualmente, al mostrar el desarrollo de este fen√≥meno inflacionario hasta su etapa de estabilizaci√≥n permite que se tenga conocimiento no solo de las causas y consecuencias de los periodos de crisis inflacionarias, sino tambi√©n de las maneras que se utiliz√≥ para solucionarlos y sobre todo las debilidades del Estado en el proceso. Por ende, nos permite reconocer estos errores del pasado y potencia que seamos capaces de aceptar que deben ser solucionados del todo para evitar as√≠ nuestro retorno a las etapas de crisis precedentes. Este recordatorio es sumamente importante sobre todo en el periodo actual, pues la debilidad institucional y estatal que sigue presente, debido a la intensificaci√≥n de las luchas pol√≠ticas internas y la expansi√≥n de la corrupci√≥n, est√° en v√≠as de limitar las capacidades de arbitraje estatal y poner en peligro la estabilizaci√≥n econ√≥mica lograda.
# 
# En suma, podemos decir que La Historia Monetaria y Fiscal del Per√∫, 1960-2017 resalta las causas y efectos de las crisis inflatorias entre 1970-1987 y su periodo de estabilizaci√≥n a partir de 1990, sin embargo, ahora que ya sabemos lo que pasaba durante este periodo de tiempo y sus efectos en la pol√≠tica macroecon√≥mica peruana desde el enfoque monetario y la perspectiva institucional, el siguiente paso ser√≠a investigar el tema desde otros enfoques, de modo que se encuentren otros factores que hayan generado esta crisis o que hayan propiciado su existencia. Seg√∫n Llosa y Panizza (2015) existen muchos elementos que explican el periodo de inflaci√≥n y la lenta recuperaci√≥n de la econom√≠a peruana, pues hubo tantos choques externos e internos durante el periodo de 1970-1990 y sus efectos negativos intensificaron los efectos de otros, por tanto no se puede hablar de una sola causa para el fen√≥meno. Por ende, una investigaci√≥n desde un enfoque nuevo o desde una perspectiva diferente a la institucional como la estructural o la cultural ayudar√≠a a complementar los resultados de la investigaci√≥n de Martinelli y Vega.
# 
# - Bibliograf√≠a
# 
# 
# Llosa, L. G., y Panizza, U. (2015). La gran depresi√≥n de la econom√≠a peruana:¬ø Una tormenta perfecta?. Revista Estudios Econ√≥micos, (30), 91-117. https://www.bcrp.gob.pe/publicaciones/revista-estudios-economicos/ree-30-05-la-gran-depresion-de-la-economia-peruana-una-tormenta-perfecta.html

# ## C√≥digo en Python: 
# Greysi Arrelucea (20200279) y Roxana Rodriguez Pilco (20200373)

# In[1]:


import ipywidgets as widgets
import matplotlib.pyplot as plt
import numpy as np
import sympy as sy
import pandas as pd
from causalgraphicalmodels import CausalGraphicalModel


# ### a. El Modelo Ingreso-Gasto: la Curva IS

# #### a.1) Utilizando las ecuaciones derive paso a paso la curva IS matem√°ticamente (a partir de la condici√≥n de equilibrio Y = DA).

# - Derivaci√≥n de la curva IS
# La curva IS se deriva de la igualdad entre el ingreso ($Y$) y la demanda agregada ($DA$):
# 
# $$Y=C+I+G+X-M$$
# 
# Entonces, considerando las siguientes ecuaciones:
# 
# $$C= C_0 + bY^d$$
# 
# $$I= I_0 + hr$$
# 
# $$G= G_0$$
# 
# $$T= tY$$
# 
# $$X= X_0$$
# 
# $$M= mY^d$$
# 
# Para llegar al equilibrio Ahorro-Inversi√≥n, se debe restar la tributaci√≥n ($T$) de ambos miembros de la igualdad:
# 
# $$Y-T = C+I+G+X-M-T$$ 
# 
# $$Y^d=C+I+G+X-M-T$$
# 
# $$Y^d-C-G-X+M+T = I$$
# 
# Esta igualdad se puede reescribir de la siguiente forma:
# 
# $$(Y^d-C)+(T-G)+(M-X)=I$$
# 
# Las tres partes de la derecha constituyen los tres componentes del ahorro total($S$): ahorro privado ($Sp=Y^d-C$) , ahorro del gobierno ($Sg=T-G$) y ahorro externo ($Se=M-X$):
# 
# $$S=Sp+Sg+Se$$
# 
# De modo que, el ahorro total ($S$) es igual a la inversi√≥n($I$):
# 
# $$Sp+Sg+Se=I$$
# 
# $$S(Y)=I(r)$$
# 
# Haciendo reemplazos se obtiene que:
# 
# $$Sp+Sg+Se=I_0-hr$$
# 
# $$(Y^d-C_0-bY^d)+(T-G_0)+(mY^d-X_0)=I_0-hr$$
# 
# Considerando las observaciones anteriores sobre los componentes de la condici√≥n de equilibrio ($Y$):
# 
# $$ [1 - (b - m)(1 - t)]Y - (C_0 + G_0 + X_0) = I_0 - hr $$
# 
# Entonces, la curva IS se puede expresar con una ecuaci√≥n donde la tasa de inter√©s es una funci√≥n del ingreso:
# 
# $$ hr = (C_0 + G_0 + I_0 + X_0) - [1 - (b - m)(1 - t)]Y $$
# 
# luego, la sensibilidad de inversi√≥n ante la tasa de inter√©s $h$ pasa al otro lado de la ecuaci√≥n dividiendo todos los componentes y resulta:
# 
# $$ r = \frac{1}{h}(C_0 + G_0 + I_0 + X_0) - \frac{1 - (b - m)(1 - t)}{h}Y $$
# 
# Y puede simplificarse en:
# 
# $$ r = \frac{B_0}{h} - \frac{B_1}{h}Y $$
# 
# Siendo $ B_0 = C_0 + G_0 + I_0 + X_0  $ el intercepto y la pendiente $  B_1 = 1 - (b - m)(1 - t) $
# 

# #### a.2) Utilizando la funci√≥n de equilibrio IS donde r est√° en funci√≥n de Y, encuentre $Œîr/ŒîY$:
# 
# Recordemos la ecuaci√≥n del ingreso de equilibrio a corto plazo que fue obtenida a partir del equilibrio $(Y = DA)$:
# 
# $$ Y = \frac{1}{1 - (b - m)(1 - t)} (C_0 + I_0 + G_0 + X_0 - hr) $$
# 
# Esta ecuaci√≥n, despu√©s de algunas operaciones, puede expresarse en funci√≥n de la tasa de inter√©s $(r)$:
# 
# $$ r = \frac{1}{h}(C_0 + G_0 + I_0 + X_0) - \frac{1 - (b - m)(1 - t)}{h}Y $$
# 
# Entonces, la curva IS puede ser simplificada de la siguiente manera:
# 
# $$ r = \frac{B_0}{h} - \frac{B_1}{h}Y $$
# 
# Donde $ B_0 = C_0 + G_0 + I_0 + X_0  $ y $  B_1 = 1 - (b - m)(1 - t) $
# 
# Por tanto, un cambio en la tasa de inter√©s ante una variaci√≥n en el producto es:
# 
# $$ \frac{Œîr}{ŒîY} = - (\frac{1-(b-m)(1-t)}{h} ) < 0 $$
# 
# Donde, $(\frac{1-(b-m)(1-t)}{h}) > 0 $, pero debido al signo negativo $(-)$ que tiene delante se convierte en: $(-)(+)= (-)$ y por eso el cambio ser√≠a negativo (< 0) y esto reflejar√≠a una relaci√≥n entre la tasa de inter√©s y el producto negativa.
# 

# #### a.3) Lea la secci√≥n 4.4 del material de ense√±anza y explique c√≥mo se deriva la curva IS a partir del equilibrio  y grafique lo siguiente:
# En el modelo ingreso-gasto, el equilibrio entre el Ingreso y la demanda agregada representa el equilibrio en el mercado de bienes.Adem√°s, a partir de este equilibrio se puede obtener la curva IS. 
# Como se mostr√≥ en los apartados anteriores, a partir de reemplazos en la ecuaci√≥n que representa la condici√≥n de equilibrio $DA=Y$ se obtiene: 
# 
# $$ Y = \frac{1}{1-(b-m)(1-t)}(C_0 + G_0 + I_0 + X_0) - \frac{h}{1 - (b - m)(1 - t)}r $$  
# 
# √≥, lo que es lo mismo,    
# 
# $$ r = \frac{1}{h}(C_0 + G_0 + I_0 + X_0) - \frac{1 - (b - m)(1 - t)}{h}Y $$
# 
# - Explicaci√≥n de derivaci√≥n gr√°fica
# 
# Esta ecuaci√≥n de derivaci√≥n expresa que hay un conjunto de pares ordenados $(Y,r)$, representando $Y$ al ingreso y $r$ a la tasa de inter√©s, las cuales van a equilibrar el mercado de bienes. Este par de valores tiene una relaci√≥n inversa, por ende al graficarlo la pendiente de la curva IS es negativa. Esta relaci√≥n inversa se puede ilustrar gr√°ficamente a partir del equilibro ùê∑ùê¥ = ùëå en la recta de 45¬∞. De modo que, a partir de un ingreso de equilibrio $Y_0$ que se obtiene en base a una tasa de inter√©s $r_0$ y si suponemos que se hizo una reducci√≥n en la tasa de inter√©s, la cual cambia la tasa de inter√©s de $r_0$ a $r_1$, siendo esta menor que la primera, entonces ante esta reducci√≥n, el intercepto de la funci√≥n $DA$ aumentar√°, lo que genera un despalzamiento hacia la derecha (hacia arriba) y a su vez produciendo un aumento del ingreso de equilibrio, el cual se llamar√° $Y_1$.
# 
# Por tanto, son estas desigualdades: $r_0 > r_1$ y $Y_0 < Y_1$, las cuales representan los valores de la tasa de inter√©s y
# del ingreso que  que van a equilibrar el mercado de bienes, los cuales como ya se mencion√≥ se pueden representar en el plano (Y, r) por medio de una recta con pendiente negativa (\) que pasar√° por lo puntos ($Y_0, r_0$) y ($Y_1, r_1$). Finalmente, es esta recta con pendiente negativa la que es conocida como la Curva IS y que representa el equilibrio en el mercado de bienes.

# - Para hacer la derivaci√≥n gr√°fica, se tiene que recordar la ecuaci√≥n de la Demanda Agregada ($DA$) :

# In[2]:


# Par√°metros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3
r = 0.9

Y = np.arange(Y_size)

# Ecuaci√≥n de la curva del ingreso de equilibrio

def DA_K(Co, Io, Go, Xo, h, r, b, m, t, Y):
    DA_K = (Co + Io + Go + Xo - h*r) + ((b - m)*(1 - t)*Y)
    return DA_K

DA_IS_K = DA_K(Co, Io, Go, Xo, h, r, b, m, t, Y)

#--------------------------------------------------
# Recta de 45¬∞

a = 2.5 

def L_45(a, Y):
    L_45 = a*Y
    return L_45

L_45 = L_45(a, Y)

#--------------------------------------------------
# Segunda curva de ingreso de equilibrio

# Definir cualquier par√°metro aut√≥nomo
Go = 95

# Generar la ecuaci√≥n con el nuevo par√°metro
def DA_K(Co, Io, Go, Xo, h, r, b, m, t, Y):
    DA_K = (Co + Io + Go + Xo - h*r) + ((b - m)*(1 - t)*Y)
    return DA_K

DA_G = DA_K(Co, Io, Go, Xo, h, r, b, m, t, Y)


# In[3]:


# Par√°metros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuaci√≥n 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


# In[4]:


# Gr√°fico de la derivaci√≥n de la curva IS a partir de la igualdad (DA = Y)

    # Dos gr√°ficos en un solo cuadro (ax1 para el primero y ax2 para el segundo)
fig, (ax1, ax2) = plt.subplots(2, figsize=(8, 16)) 

#---------------------------------
    # Gr√°fico 1: ingreso de Equilibrio
ax1.yaxis.set_major_locator(plt.NullLocator())   
ax1.xaxis.set_major_locator(plt.NullLocator())

ax1.plot(Y, DA_IS_K, label = "DA_0", color = "#400080") 
ax1.plot(Y, DA_G, label = "DA_1", color = "#9370db") 
ax1.plot(Y, L_45, color = "#404040") 

ax1.axvline(x = 70.5, ymin= 0, ymax = 0.69, linestyle = ":", color = "C4")
ax1.axvline(x = 82.5,  ymin= 0, ymax = 0.80, linestyle = ":", color = "C4")

ax1.text(6, 4, '$45¬∞$', fontsize = 11.5, color = 'black')
ax1.text(2.5, -3, '$‚óù$', fontsize = 30, color = 'black')
ax1.text(72, 0, '$Y_0$', fontsize = 12, color = 'purple')
ax1.text(84, 0, '$Y_1$', fontsize = 12, color = 'purple')
ax1.text(67, 185, 'E_0', fontsize = 12, color = 'purple')
ax1.text(84, 169, 'DA(r0)', fontsize = 12, color = 'purple')
ax1.text(74, 210, 'E_1', fontsize = 12, color = 'purple')
ax1.text(84, 200, 'DA(r1);siendo r1<r0', fontsize = 12, color = 'purple')
ax1.set(title = "Derivaci√≥n de la curva IS a partir del equilibrio $Y=DA$", xlabel = r'Y', ylabel = r'DA')
ax1.legend()

#---------------------------------
    # Gr√°fico 2: Curva IS

ax2.yaxis.set_major_locator(plt.NullLocator())   
ax2.xaxis.set_major_locator(plt.NullLocator())

ax2.plot(Y, r, label = "IS", color = "C6") 
ax2.axvline(x = 70.5, ymin= 0, ymax = 1, linestyle = ":", color = "C4")
ax2.axvline(x = 82.5,  ymin= 0, ymax = 1, linestyle = ":", color = "C4")
plt.axhline(y = 151.5, xmin= 0, xmax = 0.7, linestyle = ":", color = "C4")
plt.axhline(y = 141.5, xmin= 0, xmax = 0.8, linestyle = ":", color = "C4")

ax2.text(72, 128, '$Y_0$', fontsize = 12, color = 'purple')
ax2.text(84, 128, '$Y_1$', fontsize = 12, color = 'purple')
ax2.text(1, 153, '$r_0$', fontsize = 12, color = 'purple')
ax2.text(1, 143, '$r_1$', fontsize = 12, color = 'purple')
ax2.text(72, 152, 'E_0', fontsize = 12, color = 'purple')
ax2.text(84, 143, 'E_1', fontsize = 12, color = 'purple')


ax2.legend()

plt.show()


# ### b. La Curva IS o el equilibrio Ahorro- Inversi√≥n

# #### b.1) Derive la ecuaci√≥n de IS a partir de la igualdad Ahorro-Inversi√≥n y grafique la curva IS de equilibrio en el Mercado de Bienes

# Como se mencion√≥ en el apartado a.1): $Y= C+I+G+X-M$, y:
# 
# Para llegar al equilibrio Ahorro-Inversi√≥n, se debe restar la tributaci√≥n ($T$) de ambos miembros de la igualdad:
# 
# $$Y-T = C+I+G+X-M-T$$ 
# 
# $$Y^d=C+I+G+X-M-T$$
# 
# $$Y^d-C-G-X+M+T = I$$
# 
# Esta igualdad se puede reescribir de la siguiente forma:
# 
# $$(Y^d-C)+(T-G)+(M-X)=I$$
# 
# Las tres partes de la derecha constituyen los tres componentes del ahorro total($S$): ahorro privado ($Sp$) , ahorro del gobierno ($Sg$) y ahorro externo ($Se$):
# 
# $$S=Sp+Sg+Se$$
# 
# De modo que, el ahorro total ($S$) es igual a la inversi√≥n($I$):
# 
# $$Sp+Sg+Se=I$$
# 
# $$S(Y)=I(r)$$
# 
# Haciendo reemplazos se obtiene que:
# 
# $$Sp+Sg+Se=I_0-hr$$
# 
# $$(Y^d-C_0-bY^d)+(T-G_0)+(mY^d-X_0)=I_0-hr$$
# 
# Considerando las observaciones anteriores sobre los componentes de la condici√≥n de equilibrio ($Y$):
# 
# $$ [1 - (b - m)(1 - t)]Y - (C_0 + G_0 + X_0) = I_0 - hr $$
# 
# La curva IS se puede expresar con una ecuaci√≥n donde la tasa de inter√©s es una funci√≥n del ingreso:
# 
# $$ hr = (C_0 + G_0 + I_0 + X_0) - (1 - (b - m)(1 - t))Y $$
# 
# 
# $$ r = \frac{1}{h}(C_0 + G_0 + I_0 + X_0) - \frac{1 - (b - m)(1 - t)}{h}Y $$
# 
# Y puede simplificarse en:
# 
# $$ r = \frac{B_0}{h} - \frac{B_1}{h}Y $$
# 
# 
# Donde $ B_0 = C_0 + G_0 + I_0 + X_0  $ es el intercepto y $B_1 = 1 - (b - m)(1 - t)$ es la pendiente. 
# 

# - Y la curva IS se grafica de la siguiente manera:

# In[5]:


# Par√°metros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuaci√≥n 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


# In[6]:


# Gr√°fico de la curva IS

# Dimensiones del gr√°fico
y_max = np.max(r)
fig, ax = plt.subplots(figsize=(10, 8))

# Curvas a graficar
ax.plot(Y, r, label = "IS", color = "#7fffd4") 

# Eliminar las cantidades de los ejes
ax.yaxis.set_major_locator(plt.NullLocator())   
ax.xaxis.set_major_locator(plt.NullLocator())

# T√≠tulo, ejes y leyenda
ax.set(title = "La Curva IS de Equilibrio en el Mercado de Bienes", xlabel= 'Y', ylabel= 'r')
ax.legend()

plt.show()


# ### c. Desequilibrios en el mercado de bienes

# #### c.1) Grafique las √°reas de exceso de oferta o exceso de demanda en el mercado de bienes. Explique por qu√© estos puntos est√°n fuera de los puntos de equilibrio en el mercado de bienes. 

# In[7]:


# Par√°metros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuaci√≥n 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


# In[8]:


# Gr√°fico: Curva IS
# Dimensiones del gr√°fico
y_max = np.max(r)
fig, ax = plt.subplots(figsize=(10, 8))
ax.yaxis.set_major_locator(plt.NullLocator())   
ax.xaxis.set_major_locator(plt.NullLocator())

ax.plot(Y, r, label = "IS", color = "#40e0d0") 

#L√≠neas punteadas
ax.axvline(x = 70.5, ymin= 0, ymax = 0.45, linestyle = ":", color = "#add8e6")
ax.axvline(x = 54,  ymin= 0, ymax = 0.45, linestyle = ":", color = "#add8e6")
ax.axvline(x = 37,  ymin= 0, ymax = 0.45, linestyle = ":", color = "#add8e6")
plt.axhline(y = 165, xmin= 0, xmax = 0.693, linestyle = ":", color = "#add8e6")

#T√≠tulos, ejes y leyenda
ax.text(71, 128, '$Y_B$', fontsize = 12, color = 'blue')
ax.text(55, 128, '$Y_A$', fontsize = 12, color = 'blue')
ax.text(38, 128, '$Y_C$', fontsize = 12, color = 'blue')
ax.text(1, 167, '$r_A$', fontsize = 12, color = 'blue')
ax.text(71, 166, 'B', fontsize = 12, color = 'blue')
ax.text(55, 166, 'A', fontsize = 12, color = 'blue')
ax.text(38, 166, 'C', fontsize = 12, color = 'blue')
#Coordenadas de excesos
ax.text(70, 180, '$Exceso de Oferta$', fontsize = 12, color = 'black')
ax.text(34, 150, '$Exceso de Demanda$', fontsize = 12, color = 'black')

ax.set(title = "Equilibrio y desequilibrio en el Mercado de Bienes", xlabel= 'Y', ylabel= 'r')
ax.legend()

plt.show()


# - Explicaci√≥n:
# 
# 
# C√≥mo observamos en el gr√°fico, los puntos que conforman la curva $IS$ representan el conjunto de pares ordenados $(Y,r)$ y este conjunto de valores ordenados equilibran el mercado de bienes. Sin embargo, observamos que en el gr√°fico tambi√©n hay puntos que est√°n fuera de los puntos de equilibrio del mercado de bienes, estos son puntos de desequilibrio de mercado. Este desequilibrio se puede producir por 2 factores: un exceso de oferta (puntos ubicados a la derecha de la curva IS) o un exceso de demanda (puntos ubicados a la izquierda de la curva IS). Por ejemplo, el punto A es de equilibrio y se encuentra dentro de la curva IS, este punto denota que el par ordenado ($Y_A, r_A$) equilibra el ahorro con la inversi√≥n ($I_A = S_A$). 
# 
# Pero, el punto B, que se encuentra a la derecha de la curva IS y corresponde al par ordenado ($Y_B, r_A$) muestra que como la tasa de inter√©s se mantiene, entonces la inversi√≥n tambi√©n se mantiene igual, pero el ahorro ha aumentado en comparaci√≥n con el que corresponde al punto A, esto debido a que el ingreso aument√≥ y ahora es mayor que el ingreso correspondiente al punto A ($Y_A$), en suma, en el punto B, el ahorro del punto B es mayor que la inversi√≥n en el punto A($I_A< S_B$), por ende, a la derecha de la curva IS se observa un desequilibrio producido por un exceso de oferta. Asimismo, el punto C corresponde a los valores ordenados ($Y_C, r_A$) y representa que si bien la tasa de inter√©s se mantiene y consecuentemente la inversi√≥n tambi√©n lo hace, el ahorro ha disminuido en comparaci√≥n con el ahorro correspondiente al punto A ($Y_A$) debido a que el ingreso ha disminuido, en suma, en el punto C, el ahorro en el punto C es menor a la inversi√≥n en el punto A ($I_A > S_C$), por consiguiente, a la izquierda de la curva IS se observa un desequilibrio producido por un exceso de demanda.

# ### d. Movimientos de la curva IS

# Utilizando el modelo macroecon√≥mico en a) responda los siguiente:
# 
# ##### d.1) Analice Pol√≠tica Fiscal Contractiva con ca√≠da del Gasto del Gobierno ($ŒîG<0$). An√°lisis intuitivo y gr√°fico.
# 

# -Intuici√≥n:
# 
# $$ Go‚Üì  ‚Üí  G‚Üì  ‚Üí  DA‚Üì  ‚Üí  DA < Y  ‚Üí  Y‚Üì $$
# 
# La disminuci√≥n del gasto aut√≥nomo, disminuye el gasto p√∫blico, por ende, la demanda agregada de bienes tambi√©n disminuye, generando as√≠ una reducci√≥n de demanda, lo que da lugar a un desplazamiento de la curva IS hacia la izquierda, donde, como se ha mostrado anteriormente, hay exceso de demanda. 

# In[9]:


# Curva IS original

# Par√°metros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuaci√≥n 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


#--------------------------------------------------
    # NUEVA curva IS
    
# Definir SOLO el par√°metro cambiado
Go = 55

# Generar la ecuaci√≥n con el nuevo par√°metro
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r_G = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)
    # Gr√°fico


# In[10]:


# Gr√°fico

# Dimensiones del gr√°fico
y_max = np.max(r)
fig, ax = plt.subplots(figsize=(10, 8))

# Curvas a graficar
ax.plot(Y, r, label = "IS", color = "purple") #IS orginal
ax.plot(Y, r_G, label = "IS_G", color = "C6", linestyle = 'dashed') #Nueva IS

# Texto agregado
plt.text(43, 162, '‚àÜGo', fontsize=12, color='black')
plt.text(44, 159, '‚Üê', fontsize=15, color='blue')

# T√≠tulo, ejes y leyenda
ax.set(title = "Disminuci√≥n en el Gasto de Gobierno $(G_0)$", xlabel= 'Y', ylabel= 'r')
ax.legend()

plt.show()


# #### d.2) Analice una Pol√≠tica Fiscal Expansiva con una ca√≠da de la Tasa de Impuestos($Œît<0$). An√°lisis intuitivo y gr√°fico.

# - Intuici√≥n:
# 
# $$ t‚Üì ‚Üí Co‚Üë ‚Üí C‚Üë ‚Üí DA‚Üë ‚Üí DA > Y ‚Üí Y‚Üë $$
# 
# $$ t‚Üì ‚Üí M‚Üë ‚Üí DA‚Üì ‚Üí DA < Y ‚Üí Y‚Üì $$

# De manera intuitiva puede parecer que se llega a una contradicci√≥n, pero por teor√≠a de la curva IS se sabe que una reducci√≥n de la tasa de tributaci√≥n reduce el consumo ($C$) y produce un aumento de la demanda agregada ($DA$) y de la producci√≥n ($Y$) aunque la tasa de inter√©s ($r$) se mantiene, generando as√≠ un desplazamiento hacia la derecha, donde hay exceso de oferta.
# 
# El cambio en el par√°metro $t$ modifica la pendiente de la curva IS. Si se adopta una pol√≠tica fiscal expansiva y por ende se
# reduce la tasa de impuestos, la pendiente de la IS disminuir√°, provocando un movimiento en el sentido de las agujas del reloj hacia la derecha.

# - Gr√°fico:

# In[11]:


# Curva IS original
# Par√°metros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuaci√≥n 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


#--------------------------------------------------
    # NUEVA curva IS
    
# Definir SOLO el par√°metro cambiado
t = 0.05

# Generar la ecuaci√≥n con el nuevo par√°metro
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r_t = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


# In[12]:


# Gr√°fico

# Dimensiones del gr√°fico
y_max = np.max(r)
fig, ax = plt.subplots(figsize=(10, 8))

# Curvas a graficar
ax.plot(Y, r, label = "IS", color = "green") #IS orginal
ax.plot(Y, r_t, label = "IS_t", color = "C8", linestyle = 'dashed') #Nueva IS

# Texto agregado
plt.text(67, 162, '‚àÜt', fontsize=12, color='green')
plt.text(67, 158, ' ‚Üí', fontsize=15, color='orange')

# T√≠tulo, ejes y leyenda
ax.set(title = "Disminuci√≥n en la Tasa de Inter√©s $(t)$", xlabel= 'Y', ylabel= 'r')
ax.legend()

plt.show()


# #### d.3) Analice una ca√≠da de la Propensi√≥n Marginal a Consumir($Œîb<0$) . An√°lisis intuitivo y gr√°fico.

# - Intuici√≥n:
# 
# $$ b‚Üì ‚Üí C‚Üì  ‚Üí DA‚Üì  ‚Üí DA < Y ‚Üí Y‚Üì  $$    
# 
# 
# La ca√≠da de la propensi√≥n marginal a consumir ($b$) reduce el consumo ($C$) y produce una reducci√≥n de la demanda agregada de bienes y de la producci√≥n aunque la tasa de inter√©s se mantiene, generando as√≠ un desplazamiento hacia la IZQUIERDA, donde hay exceso de demanda.
# 
# 
# El cambio en el par√°metro $b$ modifica la pendiente de la curva IS. La reducci√≥n de la propensi√≥n marginal a consumir disminuye el tama√±o del multiplicador, reduce la pendiente de la $DA$ y aumenta la pendiente de la curva $IS$, lo que provoca un movimiento de la curva en el sentido contrario a las agujas del reloj.

# - Gr√°fico:

# In[13]:


# Curva IS original
# Par√°metros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuaci√≥n 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


#--------------------------------------------------
    # NUEVA curva IS
    
# Definir SOLO el par√°metro cambiado
b = 0.5

# Generar la ecuaci√≥n con el nuevo par√°metro
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r_b = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


# In[14]:


# Gr√°fico

# Dimensiones del gr√°fico
y_max = np.max(r)
fig, ax = plt.subplots(figsize=(10, 8))

# Curvas a graficar
ax.plot(Y, r, label = "IS", color = "blue") #IS orginal
ax.plot(Y, r_b, label = "IS_t", color = "C9", linestyle = 'dashed') #Nueva IS

# Texto agregado
plt.text(49, 162, '‚àÜt', fontsize=12, color='black')
plt.text(49, 158, '‚Üê', fontsize=15, color='grey')

# T√≠tulo, ejes y leyenda
ax.set(title = "Disminuci√≥n en la PMgC $(b)$", xlabel= 'Y', ylabel= 'r')
ax.legend()

plt.show()

