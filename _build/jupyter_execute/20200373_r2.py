#!/usr/bin/env python
# coding: utf-8

# # REPORTE 2
# 
# ## Lectura

# La Historia Monetaria y Fiscal del Perú, 1960-2017 escrito por Marco Vega y César Martinelli tiene como objetivo explicar los periodos de inflación, hiperinflación y estabilización entre 1970 y 1990 en el Perú, al igual que sus efectos en la historia macroeconómica posterior hasta la actualidad. Así, mediante ejercicios de crecimiento y contabilidad fiscal muestran los problemas y la razón detrás del periodo de inflación entre los 70’s e inicios de los 80’s. Luego, discuten como la inflación se volvió una hiperinflación en los 80’s y debido a ser un régimen con una política fiscal predominantemente monetaria y una administración populista que estableció una política contraproducente de control de precios y crédito laxo, esta no pudo ser controlada hasta 1990. A partir de este año se evidenció un periodo de estabilización junto con el cambio de las políticas económicas y una actitud más responsable por parte de los políticos en cuanto a materia fiscal y monetaria. Finalmente, los autores comparten que si bien a partir de 1990, después de un traumático periodo de inflación e hiperinflación, la actitud de los políticos fue más favorable para la estabilización económica, ya que no estaban en contra de la intervención estatal ni buscaban de manera abierta satisfacer sus intereses, el estado peruano aún enfrenta problemas internos graves como la corrupción y la lucha política interna entre poderes del Estado, lo que de no ser controlado a tiempo puede poner en peligro la estabilidad institucional y sobre todo, la estabilidad macroeconómica del país. Por tanto, en base a los temas tocados en el artículo, considero que la pregunta de investigación es: ¿Cuáles son las causas y efectos en la política macroeconómica actual de los periodos de inflación, hiperinflación y estabilidad económica en el Perú entre 1970-1990? 
# 
# Ante esta pregunta, la tesis de los autores es que los periodos de inflación económica antes de la entrada al gobierno de Fujimori en 1990 se debieron a la necesidad de impuestos inflacionarios en un gobierno que mantenía una dominancia fiscal de la política monetaria. Además, la intensificación de este fenómeno macroeconómico se dio en parte por una administración populista que potenció políticas económicas deficientes de crédito flexible y control de precios. Sin embargo, estas experiencias dieron paso al aprendizaje social de la población peruana y sus autoridades, lo que derivó en la independencia de la política monetaria bajo una institución separada y políticas fiscales más moderadas, siendo esto lo que permitió el mantenimiento de la estabilidad económica en el país hasta años posteriores.
# 
# Asimismo, como toda investigación este artículo presenta ciertas fortalezas y debilidades. En primer lugar, cabe destacar que entre sus fortalezas se encuentran su “enfoque híbrido” y la manera en que está organizado el artículo, pues ambos autores mencionan que si bien su estudio sigue un enfoque monetario este se complementa con una perspectiva institucional. Además, el que utilicen no solo ejercicios de crecimiento y contabilidad fiscal para evidenciar los periodos de inflación en la economía peruana, sino que también los contextualicen con la realidad del regimen y las decisiones en materia de políticas macroeconómicas que se tomaron en cada periodo, les permite a los autores evaluar de mejor manera las crisis económicas inflacionarias, sus causas relevantes y sobre todo sus efectos en la política macroeconómica posterior. Igualmente, a los lectores les brindará una visión más integral y secuencial del problema económico a partir de un análisis cuantitativo y cualitativo de este.
# 
# De la misma manera, el artículo está organizado de una manera secuencial y utiliza gráficos y cuadros estadísticos para dinamizar la comprensión de los lectores, pues a partir de su propia evaluación de los gráficos presentados, ellos podrán llegar a una conclusión propia e incluso podrían cuestionar el planteamiento de los autores o corroborar su interpretación de los gráficos, lo que en suma, les ofrecerá un mejor entendimiento de las crisis inflacionarias en el Perú y sus efectos actuales. 
# 
# No obstante, como cualquier otra investigación, esta presenta una importante debilidad, la cual, podría afectar de cierta manera la confiabilidad del artículo. Esta consiste en que inevitablemente, durante los periodos de crisis inflacionaria y estabilización económica las tasas de cambio real fueron cambiando y estos procesos de transformación no fueron documentados debidamente, por ende, el que ellos utilizaran estos datos incompletos, significa que de manera inevitable su investigación tendrá ciertos espacios sin corroborar, que deberán ser evaluados por los lectores para realizar su conclusión final sobre el problema inflacionario y su influencia posterior.
# 
# Por otro lado, si bien la investigación presenta determinadas fortalezas y una debilidad inevitable, su contribución al mundo académico y la sociedad en general es innegable. Esto debido a que, como hemos visto, con su estudio van a mejorar la comprensión de los lectores sobre las crisis inflacionarias y les permitirán sacar sus propias conclusiones sobre los efectos que este periodo traumático generó para la política macroeconómica y sociedad actual. Les brindarán razones para entender que la percepción negativa de los peruanos sobre el intervencionismo estatal, la promoción del libre mercado por parte de políticos peruanos desde los 2000, la independización de la política monetaria en un banco central autónomo, el alejamiento de una administración fiscal populista, los controles sobre la capacidad de gasto del Congreso y en sí la moderación de la política fiscal, han probado ser intervenciones adecuadas ligadas al aprendizaje social de la sociedad peruana. 
# 
# Igualmente, al mostrar el desarrollo de este fenómeno inflacionario hasta su etapa de estabilización permite que se tenga conocimiento no solo de las causas y consecuencias de los periodos de crisis inflacionarias, sino también de las maneras que se utilizó para solucionarlos y sobre todo las debilidades del Estado en el proceso. Por ende, nos permite reconocer estos errores del pasado y potencia que seamos capaces de aceptar que deben ser solucionados del todo para evitar así nuestro retorno a las etapas de crisis precedentes. Este recordatorio es sumamente importante sobre todo en el periodo actual, pues la debilidad institucional y estatal que sigue presente, debido a la intensificación de las luchas políticas internas y la expansión de la corrupción, está en vías de limitar las capacidades de arbitraje estatal y poner en peligro la estabilización económica lograda.
# 
# En suma, podemos decir que La Historia Monetaria y Fiscal del Perú, 1960-2017 resalta las causas y efectos de las crisis inflatorias entre 1970-1987 y su periodo de estabilización a partir de 1990, sin embargo, ahora que ya sabemos lo que pasaba durante este periodo de tiempo y sus efectos en la política macroeconómica peruana desde el enfoque monetario y la perspectiva institucional, el siguiente paso sería investigar el tema desde otros enfoques, de modo que se encuentren otros factores que hayan generado esta crisis o que hayan propiciado su existencia. Según Llosa y Panizza (2015) existen muchos elementos que explican el periodo de inflación y la lenta recuperación de la economía peruana, pues hubo tantos choques externos e internos durante el periodo de 1970-1990 y sus efectos negativos intensificaron los efectos de otros, por tanto no se puede hablar de una sola causa para el fenómeno. Por ende, una investigación desde un enfoque nuevo o desde una perspectiva diferente a la institucional como la estructural o la cultural ayudaría a complementar los resultados de la investigación de Martinelli y Vega.
# 
# - Bibliografía
# 
# 
# Llosa, L. G., y Panizza, U. (2015). La gran depresión de la economía peruana:¿ Una tormenta perfecta?. Revista Estudios Económicos, (30), 91-117. https://www.bcrp.gob.pe/publicaciones/revista-estudios-economicos/ree-30-05-la-gran-depresion-de-la-economia-peruana-una-tormenta-perfecta.html

# ## Código en Python: 
# Greysi Arrelucea (20200279) y Roxana Rodriguez Pilco (20200373)

# In[1]:


import ipywidgets as widgets
import matplotlib.pyplot as plt
import numpy as np
import sympy as sy
import pandas as pd
from causalgraphicalmodels import CausalGraphicalModel


# ### a. El Modelo Ingreso-Gasto: la Curva IS

# #### a.1) Utilizando las ecuaciones derive paso a paso la curva IS matemáticamente (a partir de la condición de equilibrio Y = DA).

# - Derivación de la curva IS
# La curva IS se deriva de la igualdad entre el ingreso ($Y$) y la demanda agregada ($DA$):
# 
# $$Y=C+I+G+X-M$$
# 
# Entonces, considerando las siguientes ecuaciones:
# 
# $$C= C_0 + bY^d$$
# 
# $$I= I_0 + hr$$
# 
# $$G= G_0$$
# 
# $$T= tY$$
# 
# $$X= X_0$$
# 
# $$M= mY^d$$
# 
# Para llegar al equilibrio Ahorro-Inversión, se debe restar la tributación ($T$) de ambos miembros de la igualdad:
# 
# $$Y-T = C+I+G+X-M-T$$ 
# 
# $$Y^d=C+I+G+X-M-T$$
# 
# $$Y^d-C-G-X+M+T = I$$
# 
# Esta igualdad se puede reescribir de la siguiente forma:
# 
# $$(Y^d-C)+(T-G)+(M-X)=I$$
# 
# Las tres partes de la derecha constituyen los tres componentes del ahorro total($S$): ahorro privado ($Sp=Y^d-C$) , ahorro del gobierno ($Sg=T-G$) y ahorro externo ($Se=M-X$):
# 
# $$S=Sp+Sg+Se$$
# 
# De modo que, el ahorro total ($S$) es igual a la inversión($I$):
# 
# $$Sp+Sg+Se=I$$
# 
# $$S(Y)=I(r)$$
# 
# Haciendo reemplazos se obtiene que:
# 
# $$Sp+Sg+Se=I_0-hr$$
# 
# $$(Y^d-C_0-bY^d)+(T-G_0)+(mY^d-X_0)=I_0-hr$$
# 
# Considerando las observaciones anteriores sobre los componentes de la condición de equilibrio ($Y$):
# 
# $$ [1 - (b - m)(1 - t)]Y - (C_0 + G_0 + X_0) = I_0 - hr $$
# 
# Entonces, la curva IS se puede expresar con una ecuación donde la tasa de interés es una función del ingreso:
# 
# $$ hr = (C_0 + G_0 + I_0 + X_0) - [1 - (b - m)(1 - t)]Y $$
# 
# luego, la sensibilidad de inversión ante la tasa de interés $h$ pasa al otro lado de la ecuación dividiendo todos los componentes y resulta:
# 
# $$ r = \frac{1}{h}(C_0 + G_0 + I_0 + X_0) - \frac{1 - (b - m)(1 - t)}{h}Y $$
# 
# Y puede simplificarse en:
# 
# $$ r = \frac{B_0}{h} - \frac{B_1}{h}Y $$
# 
# Siendo $ B_0 = C_0 + G_0 + I_0 + X_0  $ el intercepto y la pendiente $  B_1 = 1 - (b - m)(1 - t) $
# 

# #### a.2) Utilizando la función de equilibrio IS donde r está en función de Y, encuentre $Δr/ΔY$:
# 
# Recordemos la ecuación del ingreso de equilibrio a corto plazo que fue obtenida a partir del equilibrio $(Y = DA)$:
# 
# $$ Y = \frac{1}{1 - (b - m)(1 - t)} (C_0 + I_0 + G_0 + X_0 - hr) $$
# 
# Esta ecuación, después de algunas operaciones, puede expresarse en función de la tasa de interés $(r)$:
# 
# $$ r = \frac{1}{h}(C_0 + G_0 + I_0 + X_0) - \frac{1 - (b - m)(1 - t)}{h}Y $$
# 
# Entonces, la curva IS puede ser simplificada de la siguiente manera:
# 
# $$ r = \frac{B_0}{h} - \frac{B_1}{h}Y $$
# 
# Donde $ B_0 = C_0 + G_0 + I_0 + X_0  $ y $  B_1 = 1 - (b - m)(1 - t) $
# 
# Por tanto, un cambio en la tasa de interés ante una variación en el producto es:
# 
# $$ \frac{Δr}{ΔY} = - (\frac{1-(b-m)(1-t)}{h} ) < 0 $$
# 
# Donde, $(\frac{1-(b-m)(1-t)}{h}) > 0 $, pero debido al signo negativo $(-)$ que tiene delante se convierte en: $(-)(+)= (-)$ y por eso el cambio sería negativo (< 0) y esto reflejaría una relación entre la tasa de interés y el producto negativa.
# 

# #### a.3) Lea la sección 4.4 del material de enseñanza y explique cómo se deriva la curva IS a partir del equilibrio  y grafique lo siguiente:
# En el modelo ingreso-gasto, el equilibrio entre el Ingreso y la demanda agregada representa el equilibrio en el mercado de bienes.Además, a partir de este equilibrio se puede obtener la curva IS. 
# Como se mostró en los apartados anteriores, a partir de reemplazos en la ecuación que representa la condición de equilibrio $DA=Y$ se obtiene: 
# 
# $$ Y = \frac{1}{1-(b-m)(1-t)}(C_0 + G_0 + I_0 + X_0) - \frac{h}{1 - (b - m)(1 - t)}r $$  
# 
# ó, lo que es lo mismo,    
# 
# $$ r = \frac{1}{h}(C_0 + G_0 + I_0 + X_0) - \frac{1 - (b - m)(1 - t)}{h}Y $$
# 
# - Explicación de derivación gráfica
# 
# Esta ecuación de derivación expresa que hay un conjunto de pares ordenados $(Y,r)$, representando $Y$ al ingreso y $r$ a la tasa de interés, las cuales van a equilibrar el mercado de bienes. Este par de valores tiene una relación inversa, por ende al graficarlo la pendiente de la curva IS es negativa. Esta relación inversa se puede ilustrar gráficamente a partir del equilibro 𝐷𝐴 = 𝑌 en la recta de 45°. De modo que, a partir de un ingreso de equilibrio $Y_0$ que se obtiene en base a una tasa de interés $r_0$ y si suponemos que se hizo una reducción en la tasa de interés, la cual cambia la tasa de interés de $r_0$ a $r_1$, siendo esta menor que la primera, entonces ante esta reducción, el intercepto de la función $DA$ aumentará, lo que genera un despalzamiento hacia la derecha (hacia arriba) y a su vez produciendo un aumento del ingreso de equilibrio, el cual se llamará $Y_1$.
# 
# Por tanto, son estas desigualdades: $r_0 > r_1$ y $Y_0 < Y_1$, las cuales representan los valores de la tasa de interés y
# del ingreso que  que van a equilibrar el mercado de bienes, los cuales como ya se mencionó se pueden representar en el plano (Y, r) por medio de una recta con pendiente negativa (\) que pasará por lo puntos ($Y_0, r_0$) y ($Y_1, r_1$). Finalmente, es esta recta con pendiente negativa la que es conocida como la Curva IS y que representa el equilibrio en el mercado de bienes.

# - Para hacer la derivación gráfica, se tiene que recordar la ecuación de la Demanda Agregada ($DA$) :

# In[2]:


# Parámetros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3
r = 0.9

Y = np.arange(Y_size)

# Ecuación de la curva del ingreso de equilibrio

def DA_K(Co, Io, Go, Xo, h, r, b, m, t, Y):
    DA_K = (Co + Io + Go + Xo - h*r) + ((b - m)*(1 - t)*Y)
    return DA_K

DA_IS_K = DA_K(Co, Io, Go, Xo, h, r, b, m, t, Y)

#--------------------------------------------------
# Recta de 45°

a = 2.5 

def L_45(a, Y):
    L_45 = a*Y
    return L_45

L_45 = L_45(a, Y)

#--------------------------------------------------
# Segunda curva de ingreso de equilibrio

# Definir cualquier parámetro autónomo
Go = 95

# Generar la ecuación con el nuevo parámetro
def DA_K(Co, Io, Go, Xo, h, r, b, m, t, Y):
    DA_K = (Co + Io + Go + Xo - h*r) + ((b - m)*(1 - t)*Y)
    return DA_K

DA_G = DA_K(Co, Io, Go, Xo, h, r, b, m, t, Y)


# In[3]:


# Parámetros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuación 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


# In[4]:


# Gráfico de la derivación de la curva IS a partir de la igualdad (DA = Y)

    # Dos gráficos en un solo cuadro (ax1 para el primero y ax2 para el segundo)
fig, (ax1, ax2) = plt.subplots(2, figsize=(8, 16)) 

#---------------------------------
    # Gráfico 1: ingreso de Equilibrio
ax1.yaxis.set_major_locator(plt.NullLocator())   
ax1.xaxis.set_major_locator(plt.NullLocator())

ax1.plot(Y, DA_IS_K, label = "DA_0", color = "#400080") 
ax1.plot(Y, DA_G, label = "DA_1", color = "#9370db") 
ax1.plot(Y, L_45, color = "#404040") 

ax1.axvline(x = 70.5, ymin= 0, ymax = 0.69, linestyle = ":", color = "C4")
ax1.axvline(x = 82.5,  ymin= 0, ymax = 0.80, linestyle = ":", color = "C4")

ax1.text(6, 4, '$45°$', fontsize = 11.5, color = 'black')
ax1.text(2.5, -3, '$◝$', fontsize = 30, color = 'black')
ax1.text(72, 0, '$Y_0$', fontsize = 12, color = 'purple')
ax1.text(84, 0, '$Y_1$', fontsize = 12, color = 'purple')
ax1.text(67, 185, 'E_0', fontsize = 12, color = 'purple')
ax1.text(84, 169, 'DA(r0)', fontsize = 12, color = 'purple')
ax1.text(74, 210, 'E_1', fontsize = 12, color = 'purple')
ax1.text(84, 200, 'DA(r1);siendo r1<r0', fontsize = 12, color = 'purple')
ax1.set(title = "Derivación de la curva IS a partir del equilibrio $Y=DA$", xlabel = r'Y', ylabel = r'DA')
ax1.legend()

#---------------------------------
    # Gráfico 2: Curva IS

ax2.yaxis.set_major_locator(plt.NullLocator())   
ax2.xaxis.set_major_locator(plt.NullLocator())

ax2.plot(Y, r, label = "IS", color = "C6") 
ax2.axvline(x = 70.5, ymin= 0, ymax = 1, linestyle = ":", color = "C4")
ax2.axvline(x = 82.5,  ymin= 0, ymax = 1, linestyle = ":", color = "C4")
plt.axhline(y = 151.5, xmin= 0, xmax = 0.7, linestyle = ":", color = "C4")
plt.axhline(y = 141.5, xmin= 0, xmax = 0.8, linestyle = ":", color = "C4")

ax2.text(72, 128, '$Y_0$', fontsize = 12, color = 'purple')
ax2.text(84, 128, '$Y_1$', fontsize = 12, color = 'purple')
ax2.text(1, 153, '$r_0$', fontsize = 12, color = 'purple')
ax2.text(1, 143, '$r_1$', fontsize = 12, color = 'purple')
ax2.text(72, 152, 'E_0', fontsize = 12, color = 'purple')
ax2.text(84, 143, 'E_1', fontsize = 12, color = 'purple')


ax2.legend()

plt.show()


# ### b. La Curva IS o el equilibrio Ahorro- Inversión

# #### b.1) Derive la ecuación de IS a partir de la igualdad Ahorro-Inversión y grafique la curva IS de equilibrio en el Mercado de Bienes

# Como se mencionó en el apartado a.1): $Y= C+I+G+X-M$, y:
# 
# Para llegar al equilibrio Ahorro-Inversión, se debe restar la tributación ($T$) de ambos miembros de la igualdad:
# 
# $$Y-T = C+I+G+X-M-T$$ 
# 
# $$Y^d=C+I+G+X-M-T$$
# 
# $$Y^d-C-G-X+M+T = I$$
# 
# Esta igualdad se puede reescribir de la siguiente forma:
# 
# $$(Y^d-C)+(T-G)+(M-X)=I$$
# 
# Las tres partes de la derecha constituyen los tres componentes del ahorro total($S$): ahorro privado ($Sp$) , ahorro del gobierno ($Sg$) y ahorro externo ($Se$):
# 
# $$S=Sp+Sg+Se$$
# 
# De modo que, el ahorro total ($S$) es igual a la inversión($I$):
# 
# $$Sp+Sg+Se=I$$
# 
# $$S(Y)=I(r)$$
# 
# Haciendo reemplazos se obtiene que:
# 
# $$Sp+Sg+Se=I_0-hr$$
# 
# $$(Y^d-C_0-bY^d)+(T-G_0)+(mY^d-X_0)=I_0-hr$$
# 
# Considerando las observaciones anteriores sobre los componentes de la condición de equilibrio ($Y$):
# 
# $$ [1 - (b - m)(1 - t)]Y - (C_0 + G_0 + X_0) = I_0 - hr $$
# 
# La curva IS se puede expresar con una ecuación donde la tasa de interés es una función del ingreso:
# 
# $$ hr = (C_0 + G_0 + I_0 + X_0) - (1 - (b - m)(1 - t))Y $$
# 
# 
# $$ r = \frac{1}{h}(C_0 + G_0 + I_0 + X_0) - \frac{1 - (b - m)(1 - t)}{h}Y $$
# 
# Y puede simplificarse en:
# 
# $$ r = \frac{B_0}{h} - \frac{B_1}{h}Y $$
# 
# 
# Donde $ B_0 = C_0 + G_0 + I_0 + X_0  $ es el intercepto y $B_1 = 1 - (b - m)(1 - t)$ es la pendiente. 
# 

# - Y la curva IS se grafica de la siguiente manera:

# In[5]:


# Parámetros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuación 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


# In[6]:


# Gráfico de la curva IS

# Dimensiones del gráfico
y_max = np.max(r)
fig, ax = plt.subplots(figsize=(10, 8))

# Curvas a graficar
ax.plot(Y, r, label = "IS", color = "#7fffd4") 

# Eliminar las cantidades de los ejes
ax.yaxis.set_major_locator(plt.NullLocator())   
ax.xaxis.set_major_locator(plt.NullLocator())

# Título, ejes y leyenda
ax.set(title = "La Curva IS de Equilibrio en el Mercado de Bienes", xlabel= 'Y', ylabel= 'r')
ax.legend()

plt.show()


# ### c. Desequilibrios en el mercado de bienes

# #### c.1) Grafique las áreas de exceso de oferta o exceso de demanda en el mercado de bienes. Explique por qué estos puntos están fuera de los puntos de equilibrio en el mercado de bienes. 

# In[7]:


# Parámetros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuación 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


# In[8]:


# Gráfico: Curva IS
# Dimensiones del gráfico
y_max = np.max(r)
fig, ax = plt.subplots(figsize=(10, 8))
ax.yaxis.set_major_locator(plt.NullLocator())   
ax.xaxis.set_major_locator(plt.NullLocator())

ax.plot(Y, r, label = "IS", color = "#40e0d0") 

#Líneas punteadas
ax.axvline(x = 70.5, ymin= 0, ymax = 0.45, linestyle = ":", color = "#add8e6")
ax.axvline(x = 54,  ymin= 0, ymax = 0.45, linestyle = ":", color = "#add8e6")
ax.axvline(x = 37,  ymin= 0, ymax = 0.45, linestyle = ":", color = "#add8e6")
plt.axhline(y = 165, xmin= 0, xmax = 0.693, linestyle = ":", color = "#add8e6")

#Títulos, ejes y leyenda
ax.text(71, 128, '$Y_B$', fontsize = 12, color = 'blue')
ax.text(55, 128, '$Y_A$', fontsize = 12, color = 'blue')
ax.text(38, 128, '$Y_C$', fontsize = 12, color = 'blue')
ax.text(1, 167, '$r_A$', fontsize = 12, color = 'blue')
ax.text(71, 166, 'B', fontsize = 12, color = 'blue')
ax.text(55, 166, 'A', fontsize = 12, color = 'blue')
ax.text(38, 166, 'C', fontsize = 12, color = 'blue')
#Coordenadas de excesos
ax.text(70, 180, '$Exceso de Oferta$', fontsize = 12, color = 'black')
ax.text(34, 150, '$Exceso de Demanda$', fontsize = 12, color = 'black')

ax.set(title = "Equilibrio y desequilibrio en el Mercado de Bienes", xlabel= 'Y', ylabel= 'r')
ax.legend()

plt.show()


# - Explicación:
# 
# 
# Cómo observamos en el gráfico, los puntos que conforman la curva $IS$ representan el conjunto de pares ordenados $(Y,r)$ y este conjunto de valores ordenados equilibran el mercado de bienes. Sin embargo, observamos que en el gráfico también hay puntos que están fuera de los puntos de equilibrio del mercado de bienes, estos son puntos de desequilibrio de mercado. Este desequilibrio se puede producir por 2 factores: un exceso de oferta (puntos ubicados a la derecha de la curva IS) o un exceso de demanda (puntos ubicados a la izquierda de la curva IS). Por ejemplo, el punto A es de equilibrio y se encuentra dentro de la curva IS, este punto denota que el par ordenado ($Y_A, r_A$) equilibra el ahorro con la inversión ($I_A = S_A$). 
# 
# Pero, el punto B, que se encuentra a la derecha de la curva IS y corresponde al par ordenado ($Y_B, r_A$) muestra que como la tasa de interés se mantiene, entonces la inversión también se mantiene igual, pero el ahorro ha aumentado en comparación con el que corresponde al punto A, esto debido a que el ingreso aumentó y ahora es mayor que el ingreso correspondiente al punto A ($Y_A$), en suma, en el punto B, el ahorro del punto B es mayor que la inversión en el punto A($I_A< S_B$), por ende, a la derecha de la curva IS se observa un desequilibrio producido por un exceso de oferta. Asimismo, el punto C corresponde a los valores ordenados ($Y_C, r_A$) y representa que si bien la tasa de interés se mantiene y consecuentemente la inversión también lo hace, el ahorro ha disminuido en comparación con el ahorro correspondiente al punto A ($Y_A$) debido a que el ingreso ha disminuido, en suma, en el punto C, el ahorro en el punto C es menor a la inversión en el punto A ($I_A > S_C$), por consiguiente, a la izquierda de la curva IS se observa un desequilibrio producido por un exceso de demanda.

# ### d. Movimientos de la curva IS

# Utilizando el modelo macroeconómico en a) responda los siguiente:
# 
# ##### d.1) Analice Política Fiscal Contractiva con caída del Gasto del Gobierno ($ΔG<0$). Análisis intuitivo y gráfico.
# 

# -Intuición:
# 
# $$ Go↓  →  G↓  →  DA↓  →  DA < Y  →  Y↓ $$
# 
# La disminución del gasto autónomo, disminuye el gasto público, por ende, la demanda agregada de bienes también disminuye, generando así una reducción de demanda, lo que da lugar a un desplazamiento de la curva IS hacia la izquierda, donde, como se ha mostrado anteriormente, hay exceso de demanda. 

# In[9]:


# Curva IS original

# Parámetros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuación 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


#--------------------------------------------------
    # NUEVA curva IS
    
# Definir SOLO el parámetro cambiado
Go = 55

# Generar la ecuación con el nuevo parámetro
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r_G = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)
    # Gráfico


# In[10]:


# Gráfico

# Dimensiones del gráfico
y_max = np.max(r)
fig, ax = plt.subplots(figsize=(10, 8))

# Curvas a graficar
ax.plot(Y, r, label = "IS", color = "purple") #IS orginal
ax.plot(Y, r_G, label = "IS_G", color = "C6", linestyle = 'dashed') #Nueva IS

# Texto agregado
plt.text(43, 162, '∆Go', fontsize=12, color='black')
plt.text(44, 159, '←', fontsize=15, color='blue')

# Título, ejes y leyenda
ax.set(title = "Disminución en el Gasto de Gobierno $(G_0)$", xlabel= 'Y', ylabel= 'r')
ax.legend()

plt.show()


# #### d.2) Analice una Política Fiscal Expansiva con una caída de la Tasa de Impuestos($Δt<0$). Análisis intuitivo y gráfico.

# - Intuición:
# 
# $$ t↓ → Co↑ → C↑ → DA↑ → DA > Y → Y↑ $$
# 
# $$ t↓ → M↑ → DA↓ → DA < Y → Y↓ $$

# De manera intuitiva puede parecer que se llega a una contradicción, pero por teoría de la curva IS se sabe que una reducción de la tasa de tributación reduce el consumo ($C$) y produce un aumento de la demanda agregada ($DA$) y de la producción ($Y$) aunque la tasa de interés ($r$) se mantiene, generando así un desplazamiento hacia la derecha, donde hay exceso de oferta.
# 
# El cambio en el parámetro $t$ modifica la pendiente de la curva IS. Si se adopta una política fiscal expansiva y por ende se
# reduce la tasa de impuestos, la pendiente de la IS disminuirá, provocando un movimiento en el sentido de las agujas del reloj hacia la derecha.

# - Gráfico:

# In[11]:


# Curva IS original
# Parámetros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuación 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


#--------------------------------------------------
    # NUEVA curva IS
    
# Definir SOLO el parámetro cambiado
t = 0.05

# Generar la ecuación con el nuevo parámetro
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r_t = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


# In[12]:


# Gráfico

# Dimensiones del gráfico
y_max = np.max(r)
fig, ax = plt.subplots(figsize=(10, 8))

# Curvas a graficar
ax.plot(Y, r, label = "IS", color = "green") #IS orginal
ax.plot(Y, r_t, label = "IS_t", color = "C8", linestyle = 'dashed') #Nueva IS

# Texto agregado
plt.text(67, 162, '∆t', fontsize=12, color='green')
plt.text(67, 158, ' →', fontsize=15, color='orange')

# Título, ejes y leyenda
ax.set(title = "Disminución en la Tasa de Interés $(t)$", xlabel= 'Y', ylabel= 'r')
ax.legend()

plt.show()


# #### d.3) Analice una caída de la Propensión Marginal a Consumir($Δb<0$) . Análisis intuitivo y gráfico.

# - Intuición:
# 
# $$ b↓ → C↓  → DA↓  → DA < Y → Y↓  $$    
# 
# 
# La caída de la propensión marginal a consumir ($b$) reduce el consumo ($C$) y produce una reducción de la demanda agregada de bienes y de la producción aunque la tasa de interés se mantiene, generando así un desplazamiento hacia la IZQUIERDA, donde hay exceso de demanda.
# 
# 
# El cambio en el parámetro $b$ modifica la pendiente de la curva IS. La reducción de la propensión marginal a consumir disminuye el tamaño del multiplicador, reduce la pendiente de la $DA$ y aumenta la pendiente de la curva $IS$, lo que provoca un movimiento de la curva en el sentido contrario a las agujas del reloj.

# - Gráfico:

# In[13]:


# Curva IS original
# Parámetros

Y_size = 100 

Co = 35
Io = 40
Go = 70
Xo = 2
h = 0.7
b = 0.8
m = 0.2
t = 0.3

Y = np.arange(Y_size)


# Ecuación 
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


#--------------------------------------------------
    # NUEVA curva IS
    
# Definir SOLO el parámetro cambiado
b = 0.5

# Generar la ecuación con el nuevo parámetro
def r_IS(b, m, t, Co, Io, Go, Xo, h, Y):
    r_IS = (Co + Io + Go + Xo - Y * (1-(b-m)*(1-t)))/h
    return r_IS

r_b = r_IS(b, m, t, Co, Io, Go, Xo, h, Y)


# In[14]:


# Gráfico

# Dimensiones del gráfico
y_max = np.max(r)
fig, ax = plt.subplots(figsize=(10, 8))

# Curvas a graficar
ax.plot(Y, r, label = "IS", color = "blue") #IS orginal
ax.plot(Y, r_b, label = "IS_t", color = "C9", linestyle = 'dashed') #Nueva IS

# Texto agregado
plt.text(49, 162, '∆t', fontsize=12, color='black')
plt.text(49, 158, '←', fontsize=15, color='grey')

# Título, ejes y leyenda
ax.set(title = "Disminución en la PMgC $(b)$", xlabel= 'Y', ylabel= 'r')
ax.legend()

plt.show()

